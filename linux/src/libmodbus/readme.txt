SPR: taken from http://libmodbus.org V3.0.3